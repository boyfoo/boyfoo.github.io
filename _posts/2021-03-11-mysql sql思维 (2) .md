---
layout: post
title: 'mysql sql思维 (2)'
date: 2021-03-11
author: boyfoo
tags: mysql
---

#### 表结构

```sql
DROP TABLE IF EXISTS `webusers`;
CREATE TABLE `webusers` (
  `u_id` int(11) NOT NULL AUTO_INCREMENT,
  `u_name` varchar(20) NOT NULL,
  `p_id` int(11) NOT NULL,
  PRIMARY KEY (`u_id`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of webusers
-- ----------------------------
INSERT INTO `webusers` VALUES ('1', '张三', '0');
INSERT INTO `webusers` VALUES ('2', '大胖胖', '0');
INSERT INTO `webusers` VALUES ('3', '李四', '2');
INSERT INTO `webusers` VALUES ('4', '大长脸', '2');
INSERT INTO `webusers` VALUES ('5', '小朱', '1');
INSERT INTO `webusers` VALUES ('6', '小狗', '5');
INSERT INTO `webusers` VALUES ('7', '刘九', '5');
```

#### 分组拼接字段

```sql
select GROUP_CONCAT(u_name),p_id 
FROM webusers 
GROUP BY p_id
```

根据`p_id`分组，并且将用一个分组下`u_name`字段的数据拼接到一起

#### 连接查询 

```sql
select a.*,b.u_name from 
  (select GROUP_CONCAT(u_name),p_id FROM webusers GROUP BY p_id) a 
INNER JOIN webusers b ON a.p_id = b.u_id
```

通过连接查询，查出`p_id` 对应的名称

<img src="/assets/img/post/20210311145942.jpg">