---
layout: post
title: 'cfssl 自签证书'
date: 2020-10-24
author: boyfoo
tags: 其他
---

下载cfssl工具组件

```bash
$ curl -s -L -o /bin/cfssl https://pkg.cfssl.org/R1.2/cfssl_linux-amd64
$ curl -s -L -o /bin/cfssljson https://pkg.cfssl.org/R1.2/cfssljson_linux-amd64
$ curl -s -L -o /bin/cfssl-certinfo https://pkg.cfssl.org/R1.2/cfssl-certinfo_linux-amd64

# 赋予运行权限
$ chmod +x /bin/cfssl*
```

* 根证书

`$ vim ca-csr.json`

```json
{
    "CN": "CAname", // 自定义CA机构的名字
    "key": {    // 加密算法
        "algo": "rsa",
        "size": 2048
    },
    "names": [  // 信息
        {
            "C": "CN",
            "L": "Beijing",
            "ST": "Beijing"
        }
    ],
    "ca": {
        "expiry": "175200h" // 过期时间 
    }
}
```

```bash
# 生成证书 指定配置文件为 ca-csr.json 内容直接打印至控制台
$ cfssl gencert -initca ca-csr.json

{"cert":"-----BEGIN CERTIFICATE-----
\nMIIDeDCCAmCgAwIBA......
XYzrSUZq\n-----END RSA PRIVATE KEY-----\n"}

# 不打印至控制台
# 生成后 使用 cfssljson -bare 承载模式 前缀ca
cfssl gencert -initca ca-csr.json | cfssljson -bare ca
# 生成三个文件
ca.csr 
ca-key.pem  根证书私钥
ca.pem 根证书
```